"use strict";(self.webpackChunkfairblock_docusaurus=self.webpackChunkfairblock_docusaurus||[]).push([[3887],{4794:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>l,contentTitle:()=>t,default:()=>h,frontMatter:()=>a,metadata:()=>c,toc:()=>o});var r=i(1527),s=i(7214);const a={sidebar_position:4},t="Submitting keyshares to fairyring",c={id:"running-a-node/submit_keyshare",title:"Submitting keyshares to fairyring",description:"This tutorial goes over on different ways to submit keyshares to fairyring and in particular, to the keyshare module.",source:"@site/docs/running-a-node/submit_keyshare.md",sourceDirName:"running-a-node",slug:"/running-a-node/submit_keyshare",permalink:"/docs/running-a-node/submit_keyshare",draft:!1,unlisted:!1,tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4},sidebar:"tutorialSidebar",previous:{title:"Validating on Testnet",permalink:"/docs/running-a-node/validating_on_testnet"},next:{title:"ShareGenerationClient",permalink:"/docs/running-a-node/share_generation_client"}},l={},o=[{value:"Requirements",id:"requirements",level:2},{value:"<code>fairyringclient</code>",id:"fairyringclient",level:2},{value:"Troubleshooting",id:"troubleshooting",level:3},{value:"Submitting via <code>fairyring</code> directly",id:"submitting-via-fairyring-directly",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.h1,{id:"submitting-keyshares-to-fairyring",children:["Submitting keyshares to ",(0,r.jsx)(n.code,{children:"fairyring"})]}),"\n",(0,r.jsxs)(n.p,{children:["This tutorial goes over on different ways to submit keyshares to ",(0,r.jsx)(n.code,{children:"fairyring"})," and in particular, to the ",(0,r.jsx)(n.code,{children:"keyshare"})," module.\nMake sure you have installed ",(0,r.jsx)(n.a,{href:"/docs/running-a-node/installation",children:(0,r.jsx)(n.code,{children:"fairyring"})})," prior to following the instructions below."]}),"\n",(0,r.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,r.jsxs)(n.p,{children:["In order to be able to submit keyshare to ",(0,r.jsx)(n.code,{children:"fairyring"}),", there are few requirements:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["You are a ",(0,r.jsx)(n.a,{href:"/docs/running-a-node/validating_on_testnet",children:"validator"})," in the staking module with a minimum ",(0,r.jsx)(n.code,{children:"10000000000ufairy"})," staked.\nCheck if you are currently a validator as well as how many tokens you have staked with the following command:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"fairyringd q staking validators \n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["You registered as a validator in the ",(0,r.jsx)(n.code,{children:"fairyring"})," ",(0,r.jsx)(n.code,{children:"keyshare"})," module. Check if you are in the validator set with following command:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"fairyringd q keyshare list-validator-set\n"})}),"\n",(0,r.jsxs)(n.p,{children:["You can register as a validator in the ",(0,r.jsx)(n.code,{children:"keyshare"})," module with the following command (replace ",(0,r.jsx)(n.code,{children:"YOUR_WALLET_NAME"})," with your account name in your keyring):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"fairyringd tx keyshare register-validator --from YOUR_WALLET_NAME\n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["NOTE: If you are submitting keyshares with ",(0,r.jsx)(n.code,{children:"fairyringclient"}),", you can skip registering as a validator because the client will do it for you."]})}),"\n",(0,r.jsx)(n.h2,{id:"fairyringclient",children:(0,r.jsx)(n.code,{children:"fairyringclient"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"fairyringclient"})," is a tool which:"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Fetches your master keyshare from our ",(0,r.jsx)(n.a,{href:"/docs/running-a-node/share_generation_client",children:(0,r.jsx)(n.code,{children:"ShareGenerationClient"})})]}),"\n",(0,r.jsx)(n.li,{children:"Computes the derived keyshare every block"}),"\n",(0,r.jsxs)(n.li,{children:["Automatically submits the derived keyshare to ",(0,r.jsx)(n.code,{children:"fairyring"})," every block."]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["This is the recommended way to submit keyshares.\nMake sure you have completed the steps in the ",(0,r.jsx)(n.a,{href:"/docs/running-a-node/prerequisites",children:"prerequisites"})," prior to following the instructions below."]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["Download & Install ",(0,r.jsx)(n.code,{children:"fairyringclient"})," by the following command:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"cd $HOME\ngit clone https://github.com/Fairblock/fairyringclient.git\ncd fairyringclient\ngo mod tidy\ngo install\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["Initialize the ",(0,r.jsx)(n.code,{children:"fairyringclient"})," config:"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"fairyringclient config init\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsx)(n.li,{children:"Check the client config:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"fairyringclient config show\n"})}),"\n",(0,r.jsx)(n.p,{children:"Example output of the command:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"Using config file: /Users/fairblock/.fairyringclient/config.yml\nGRPC Endpoint: 127.0.0.1:9090\nFairyRing Node Endpoint: http://127.0.0.1:26657\nChain ID: fairyring-testnet-1\nChain Denom: ufairy\nInvalidSharePauseThreshold: 5\nMetricsPort: 2222\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"4",children:["\n",(0,r.jsx)(n.li,{children:"Update the client config:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"fairyringclient config update\n"})}),"\n",(0,r.jsx)(n.p,{children:"Here are the flags for updating different field of the config:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--chain-id CHAIN_ID"}),", ",(0,r.jsx)(n.code,{children:"CHAIN_ID"})," is the chain id you are working with, the current default is ",(0,r.jsx)(n.code,{children:"fairyring-testnet-1"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--denom DENOM"}),", ",(0,r.jsx)(n.code,{children:"DENOM"})," is the token denom of the chain, default is ",(0,r.jsx)(n.code,{children:"ufairy"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--grpc-port PORT"}),", ",(0,r.jsx)(n.code,{children:"PORT"})," is the gRPC port of the node you are connecting to, default is ",(0,r.jsx)(n.code,{children:"9090"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--ip IP"}),", ",(0,r.jsx)(n.code,{children:"IP"})," is the IP address of the node you are connecting to, default is ",(0,r.jsx)(n.code,{children:'"127.0.0.1"'})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--metrics-port METRICS_PORT"}),", ",(0,r.jsx)(n.code,{children:"METRICS_PORT"})," is the port for Prometheus metrics to listen to, default is ",(0,r.jsx)(n.code,{children:"2222"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--pause-threshold THRESHOLD"}),", stops the client if it submits ",(0,r.jsx)(n.code,{children:"THRESHOLD"})," invalid keyshares in a row, default is ",(0,r.jsx)(n.code,{children:"5"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--port NODE_PORT"}),", ",(0,r.jsx)(n.code,{children:"NODE_PORT"})," is the port of the node you are connecting to, default is ",(0,r.jsx)(n.code,{children:"26657"})]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--protocol PROTOCOL"}),", ",(0,r.jsx)(n.code,{children:"PROTOCOL"})," is the protocol of the node you are connecting to, default is ",(0,r.jsx)(n.code,{children:'"http"'})]}),"\n"]}),"\n",(0,r.jsxs)(n.ol,{start:"5",children:["\n",(0,r.jsx)(n.li,{children:"Add validator account private key"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'fairyringclient keys set "private key in hex"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"The private key should be the validator address that is staking on fairyring chain"})}),"\n",(0,r.jsx)(n.p,{children:"Example:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"> fairyringclient keys set f5c691d4b53ec8c3a3ad35e88525f9b8f33d307b3414c93f1b856265409a3a04\nUsing config file: /Users/fairblock/.fairyringclient/config.ymlSuccessfully added cosmos private key to config!\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"6",children:["\n",(0,r.jsx)(n.li,{children:"Check the key is added to the client correctly:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"> fairyringclient keys show  \nUsing config file: /Users/fairblock/.fairyringclient/config.yml\nPrivate Key: f5c691d4b53ec8c3a3ad35e88525f9b8f33d307b3414c93f1b856265409a3a04  \n"})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsxs)(n.strong,{children:["The ",(0,r.jsx)(n.code,{children:"[0]"})," at the beginning of the key is the index of your key, which is used to delete the key"]})}),"\n",(0,r.jsxs)(n.ol,{start:"7",children:["\n",(0,r.jsx)(n.li,{children:"Start the client:"}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"fairyringclient start\n"})}),"\n",(0,r.jsx)(n.p,{children:"The log will look something like this when it started submitting keyshare:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"2023/01/01 00:00:00 Latest Block Height: 12345 | Deriving Share for Height: 12346                \n2023/01/01 00:00:00 Current Share Expires at: 20000 | {01 5a3cc54cb8fc2cae480a58d2922d84d69376726ed859615c6bd869154cb4ccc2}                \n2023/01/01 00:00:00 [0] Submit KeyShare for Height 12345 Confirmed\n"})}),"\n",(0,r.jsx)(n.h3,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsxs)(n.p,{children:["If you run into any issues, please refer to the\xa0",(0,r.jsx)(n.a,{href:"/docs/faqs/troubleshooting_fairyringclient",children:"troubleshooting section"})]}),"\n",(0,r.jsxs)(n.h2,{id:"submitting-via-fairyring-directly",children:["Submitting via ",(0,r.jsx)(n.code,{children:"fairyring"})," directly"]}),"\n",(0,r.jsxs)(n.p,{children:["You can submit keyshare with the ",(0,r.jsx)(n.code,{children:"fairyringd"})," binary manually.\nFirst ensure that the ",(0,r.jsx)(n.a,{href:"#requirements",children:"requirements"})," are met before proceeding."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:"fairyringd tx keyshare send-keyshare [keyshare-in-hex] [keyshare-index] [block-height] --from YOUR_ACCOUNT\n"})}),"\n",(0,r.jsx)(n.p,{children:"Here is an example command with arguments:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'fairyringd tx keyshare send-keyshare "8d9627890df55aab18188538f7d412fb03fc85ccb953c179e49a9a87e94938f414dabb308ae15e6a720a57494526c35504a49d13719718dac8ed2fabace0a1c4466e257f51d1b9243c1a519126a3024ef992b2ebe3ae965a2e9305b7247a6aa6" 1 1 --from alice\n'})}),"\n",(0,r.jsx)(n.p,{children:"Explanation on the example command:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"8d9627...a6aa6"})," is the derived keyshare encoded in hex format."]}),"\n",(0,r.jsxs)(n.li,{children:["The first ",(0,r.jsx)(n.code,{children:"1"})," is the keyshare index, which is a number starting from 1."]}),"\n",(0,r.jsxs)(n.li,{children:["The second ",(0,r.jsx)(n.code,{children:"1"})," is the keyshare height, which is the height that the keyshare derived from."]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"--from alice"})," is the account name you are sending the keyshare from, ",(0,r.jsx)(n.code,{children:"alice"})," is in this case."]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},7214:(e,n,i)=>{i.d(n,{Z:()=>c,a:()=>t});var r=i(959);const s={},a=r.createContext(s);function t(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:t(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);